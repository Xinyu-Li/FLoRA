
<!--start_PLUGINS_GENERICO_TEMPLATE_BODY-->

<script src="/flora/js/jquery.min.js"></script>
<script src="/flora/js/etherpad.js"></script>
<script src="/flora/js/diff.js"></script>
<link href="/flora/css/bootstrap.min.css" rel="stylesheet"/>
<script src="/flora/js/bootstrap.bundle.min.js"></script>
<!--    <script src="/flora/js/jquery-ui.min.js" id="myJqueryUI" ></script>-->
<script src="/flora/js/quill.min.js"></script>
<!--    <script src="/js/flipclock.js"></script>-->
<script src="/flora/js/flipdown.min.js"></script>
<script src="/flora/js/mathquill.min.js"></script> <!-- Include MathQuill JS -->

<script src="/flora/js/d3.min.js"></script>
<script src="/flora/js/jsmind.js"></script>
<script src="/flora/js/jsmind_draggable_node.js"></script>
<!-- Bootstrap Icons CSS -->
<!--    <link rel="stylesheet" href="/flora/css/font/bootstrap-icons.css">-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
<script src="/flora/js/marked.min.js"></script>
<script>
    var currentRange = null;
    var whetherDoHighlight = false;
    var saveHighlight = null;
    var saveHighlightText = '';

    var totalMinutes = 45;
    var unlimitedTime = true; //如果使用unlimited time 则让timer 变成增长，不再是count down
    var hintMinutesBeforeEnd = 5;
    var isCountdown = true;

    let eventWebsocket = null;
    let teacherChatWebsocket = null;

    var apiBaseUrl = "http://localhost:8080";
    var websocketApiBaseUrl = "ws://localhost:8080";
    var mainEditor = null;
    var editors = {}; //多个不同的侧边栏editor

    // 是否展示工具
    var useAnnotationTool = true;
    var useScaffoldTool = false; // enable
    var useGPTScaffoldTool = true;

    var srlModel = "copes";    // copes
    var gptScaffoldRole = "scaffold";


    // var gptScaffoldRoleDescription = "You are a helpful assistant, please give suggestions based on the given text.";
    var gptScaffoldPromptIncludeEssay = false;
    // 此处只需要配置ABC中的一个来标明 当前配置是哪个组的
    // var gptScaffoldPromptTemplateGroupA = "";
    var gptScaffoldPromptTemplateGroupB = "";
    // var gptScaffoldPromptTemplateGroupC = "";
    var gptScaffoldBackgroundFileNameList = [];
    var gptScaffoldParameters = [200, 1, 2]; //  response max token, n, temperature/10

    var testISDIMUCourseId = 72;
    var hasTakePreviousStudyTestNameCourseId = 72;
    var pretestNameCourseId = 72;
    var testMAICourseId = 72;

    // var userTakePreviousStudyPrompt = "This student has participated in the prior study so he/she has a certain level of task knowledge.";

    var classifySentenceBackgroundFileNameList = [""]; // cella_monash_main_task2_medicine.docx, not used

    // var srlProcessBackupPromptList = []; // 这个参数定义在 i18n 中为了支持多语言设定


    var useWriteEssayTool = true;
    var useEssayProductAnalysisTool = false;
    var allowEssayProductAnalysis = false;
    var useWriteEssayWordCountButton = false;

    var useCollaborativeWriteEssayTool = false;
    var useCollaborativeWriteEssayWordCountButton = false;
    var includeChatgptToCollaborativeWriteEssay = false;
    var useMathEditorTool = false;


    var usePlannerTool = true;
    // var useChatgptTool = false;
    // var useChatgptRating = false; // chatgpt rating visible or not

    var useZoteroNotesTool = false;
    var useProcessVisualTool = false;
    var processVisualRelatedQuestionnaireCourseId = 97;
    var processVisualRelatedQuestionnaireName = "Goal Setting Questionnaire";


    // var useConsultationSubmitTool = false;
    // var assessmentRoleDescription="You are a helpful assistant and please answers questions based on the provided text.";

    var usercolor4pad = "%23FCF3CF";


    var multiAgent4CollaborativeChatConfig = [
        {
            "agentDisplayName":"Mediator",
            "agentName":"mediator_discuss_01",// 根据课程不同需要修改 eg mediator_write_01
            "agentRole":"mediator",
            "model":"gpt-4o",
            "agentDescription":"You are the mediator. Please answer all the questions.",

            "agentAvatarSvg": "<svg t=\"1721961683121\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"5712\" width=\"35\" height=\"35\"><path d=\"M903.616 0C969.984 0 1024 54.016 1024 120.384V903.68A120.576 120.576 0 0 1 903.552 1024H120.384A120.512 120.512 0 0 1 0 903.616V120.32C0 54.016 54.016 0 120.384 0H903.68z m0 69.12H120.32a51.328 51.328 0 0 0-51.264 51.264V903.68c0 28.288 23.04 51.264 51.264 51.264H903.68c28.288 0 51.264-23.04 51.264-51.264V120.32a51.392 51.392 0 0 0-51.264-51.264zM501.952 288v58.56H268.928v115.904h218.944v58.56H268.928v126.528h242.944v58.496H200.384V288h301.568z m224.832 107.136c75.52 0 113.6 40.96 113.6 124.16v186.752h-66.752V525.12c0-49.728-22.848-74.368-68.48-74.368a61.12 61.12 0 0 0-43.328 17.6c-14.08 12.864-22.272 31.616-24.64 55.68v182.016H570.432v-302.72h66.752v35.2c9.408-11.264 19.84-20.672 31.232-27.52l8.64-4.736c15.424-7.616 32.512-11.392 49.728-11.136z\" fill=\"#f9d6ff\" p-id=\"5713\"></path></svg>",
            "agentToolIconSvg": "",

            "useAgent": false,
            "promptIncludeEssay":false,
            "backgroundFileNameList":[],
            "chatgptParameters":[1000,1,2],
        },
        {
            "agentDisplayName":"Structure",
            "agentName":"expert_structure",
            "agentRole":"expert",
            "model":"gpt-4o",
            "agentDescription":"You are the structure expert. Please answer all the questions.",

            "agentAvatarSvg": "<svg t=\"1717136978189\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"6006\" width=\"30\" height=\"30\"><path d=\"M903.616 0C969.984 0 1024 54.016 1024 120.384V903.68A120.576 120.576 0 0 1 903.552 1024H120.384A120.512 120.512 0 0 1 0 903.616V120.32C0 54.016 54.016 0 120.384 0H903.68z m0 69.12H120.32a51.328 51.328 0 0 0-51.264 51.264V903.68c0 28.288 23.04 51.264 51.264 51.264H903.68c28.288 0 51.264-23.04 51.264-51.264V120.32a51.392 51.392 0 0 0-51.264-51.264zM501.952 288v58.56H268.928v115.904h218.944v58.56H268.928v126.528h242.944v58.496H200.384V288h301.568z m224.832 107.136c75.52 0 113.6 40.96 113.6 124.16v186.752h-66.752V525.12c0-49.728-22.848-74.368-68.48-74.368a61.12 61.12 0 0 0-43.328 17.6c-14.08 12.864-22.272 31.616-24.64 55.68v182.016H570.432v-302.72h66.752v35.2c9.408-11.264 19.84-20.672 31.232-27.52l8.64-4.736c15.424-7.616 32.512-11.392 49.728-11.136z\" fill=\"#efb336\" p-id=\"6007\"></path></svg>",
            "agentToolIconSvg": "",

            "useAgent": false,
            "promptIncludeEssay":false,
            "backgroundFileNameList":[],
            "chatgptParameters":[1000,1,2],
        },

    ];

    var useMultiAgentsSingleWindowTool = false;
    var useMultiAgentsSingleWindowRating = false;
    var allowMultiAgentsSingleWindowReminder = false;
    var multiAgentsSingleWindowReminderShowTime = 60 * 7; //seconds
    var multiAgentsSingleWindowName = "Chat Assistant";

    // 所有description 都暂时没用
    // rating 部分添加到 工具层面，不能留到agent层面控制
    // 每个 agent config 都要加 useAgent 参数
    // scaffold Agent 触发方式有两种，一种是按时间触发，一种是按轮数触发，可以同时存在
    // 测试单个窗口，窗口内有多个agents
    var multiAgentsSingleWindowConfig = {};

    var useMultiAgentsMultiWindowsTool = false;
    var useMultiAgentsMultiWindowsRating = false;
    // 字数限制 写到单独的 study 工具里面
    // var wordCountLimit = 300;
    // var allowPaste = false;
    // var allowCopy = true;
    // 测试多窗口，每个窗口一个agent


    var multiAgentsMultiWindowsConfig = [
        {
            "agentDisplayName": "贝可可",
            "agentName": "mayor_beranda",
            "agentRole": "mayor",
            "model":"gpt-4o",
            "agentDescription": "You are the mayor of Beranda. Please answer all the questions.",

            "agentAvatarSvg": "<svg t=\"1720921759115\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"3165\" width=\"35\" height=\"35\"><path d=\"M486.1 488.4c107.5 0 195-86 195-191.7 0-105.7-87.5-191.7-195-191.7s-195 86-195 191.7c0 105.7 87.5 191.7 195 191.7z m0-349.5c88.5 0 160.5 70.8 160.5 157.8s-72 157.8-160.5 157.8-160.5-70.8-160.5-157.8c0-87 72-157.8 160.5-157.8z m0 261.4c58.2 0 105.4-46.4 105.5-103.7 0-9.4-7.7-17-17.3-17-9.5 0-17.3 7.6-17.3 17 0 38.5-31.8 69.7-70.9 69.7-39.2 0-70.9-31.2-70.9-69.7 0-9.4-7.7-17-17.3-17-9.5 0-17.3 7.6-17.3 17 0.1 57.3 47.3 103.7 105.5 103.7zM692 508.7H280.5c-60.3 0.1-109.1 48.1-109.2 107.3v198.7c0 9.4 7.7 17 17.3 17 9.5 0 17.3-7.6 17.3-17V616c0-40.5 33.5-73.4 74.7-73.5H692c41.2 0 74.7 32.9 74.7 73.5v198.7c0 4.5 1.8 8.8 5 12 3.2 3.2 7.6 5 12.2 5 9.5 0 17.2-7.6 17.2-17V616c0-59.2-48.9-107.3-109.1-107.3z m-188.7 69.5c-2.1-7.2-8.9-12.2-16.5-12.2s-14.4 4.9-16.5 12.1l-53 176.4c-1.8 5.9-0.2 12.2 4.2 16.6l53 53.6c3.2 3.3 7.7 5.1 12.4 5.1 4.5 0 8.8-1.7 12-4.8l53-50.5c4.6-4.4 6.3-10.9 4.6-16.9l-53.2-179.4zM487.2 789l-34-34.4 33.4-111.4 33.7 114.1-33.1 31.7z\" fill=\"#6B6B6B\" p-id=\"3166\"></path></svg>",
            "agentToolIconSvg": "<svg t=\"1713954810237\" class=\"icon\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><title>assistant mayor icon</title>\n            <path d=\"M511.83 795.59l-46.4-80.82 93.2 0.23z\" fill=\"#2c2c2c\" p-id=\"3341\" data-spm-anchor-id=\"a313x.search_index.0.i1.46d93a810kQjDt\" className=\"selected\"></path>\n            <path d=\"M511.83 556.45l-46.4 158.37 93.2-0.53z\" fill=\"#2c2c2c\" p-id=\"3342\" data-spm-anchor-id=\"a313x.search_index.0.i0.46d93a810kQjDt\" className=\"selected\"></path>\n            <path d=\"M723.88 929.64H300.17c-50.9 0-98.87-19.94-135.08-56.15-36.21-36.21-56.15-84.18-56.15-135.08 0-50.9 19.94-98.87 56.15-135.08 36.21-36.21 84.18-56.15 135.08-56.15h423.71c50.9 0 98.87 19.94 135.08 56.15 36.21 36.21 56.15 84.18 56.15 135.08 0 50.9-19.94 98.87-56.15 135.08-36.2 36.21-84.18 56.15-135.08 56.15zM300.17 607.18c-72.36 0-131.23 58.87-131.23 131.23 0 72.36 58.87 131.23 131.23 131.23h423.71c72.36 0 131.23-58.87 131.23-131.23 0-72.36-58.87-131.23-131.23-131.23H300.17zM512.03 513.91C396.77 513.91 303 420.14 303 304.88S396.77 95.85 512.03 95.85c50.32 0 177.71 0.24 178.99 0.25l29.92 0.06 0.02 29.92c0 1.31 0.1 131.34 0.1 178.81 0 115.25-93.77 209.02-209.03 209.02z m0-358.06C429.85 155.85 363 222.7 363 304.88s66.85 149.03 149.03 149.03 149.03-66.86 149.03-149.03c0-33.29-0.05-107.23-0.08-148.84-41.08-0.08-113.83-0.19-148.95-0.19z\" p-id=\"3343\"></path>\n        </svg>",
            "useAgent": true,
            "promptIncludeEssay": false,
            "backgroundFileNameList": [],
            "chatgptParameters": [1000, 1, 2],
        },
        {
            "agentDisplayName":"思思",
            "agentName":"peer_ss",
            "agentRole":"peer",
            "model":"gpt-4o",
            "agentDescription":"You are a peer. Please answer all the questions.",

            "agentAvatarSvg": "<svg t=\"1720933456267\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"6373\" width=\"35\" height=\"35\"><path d=\"M682.666667 1002.666667H213.333333V789.333333a170.666667 170.666667 0 0 1 170.666667-170.666666 85.333333 85.333333 0 0 0 85.333333 85.333333c23.68 0 42.666667-28.586667 42.666667-64 0 35.413333 18.986667 64 42.666667 64a85.333333 85.333333 0 0 0 85.333333-85.333333 170.666667 170.666667 0 0 1 170.666667 170.666666v213.333334z\" fill=\"#FFCA6B\" p-id=\"6374\"></path><path d=\"M576 618.666667h64a85.333333 85.333333 0 0 1-85.333333 85.333333c-23.68 0-42.666667-28.586667-42.666667-64a64 64 0 0 0 64-64zM512 640c0 35.413333-18.986667 64-42.666667 64a85.333333 85.333333 0 0 1-85.333333-85.333333h64v-42.666667a64 64 0 0 0 64 64z\" fill=\"#F3596B\" p-id=\"6375\"></path><path d=\"M341.333333 362.666667a172.8 172.8 0 0 0 1.28 21.12L341.333333 384h-21.333333a42.666667 42.666667 0 0 1 0-85.333333h21.333333zM448 576v-55.04a171.712 171.712 0 0 0 128 0V576a64 64 0 0 1-128 0zM746.666667 341.333333a42.794667 42.794667 0 0 1-42.666667 42.666667h-21.333333l-1.28-0.213333A172.8 172.8 0 0 0 682.666667 362.666667v-64h21.333333a42.794667 42.794667 0 0 1 42.666667 42.666666z\" fill=\"#F2CAC1\" p-id=\"6376\"></path><path d=\"M576 520.96a171.712 171.712 0 0 1-128 0 170.666667 170.666667 0 0 1-105.386667-137.173333A172.8 172.8 0 0 1 341.333333 362.666667v-85.333334h21.333334c106.666667 0 149.333333-149.333333 149.333333-149.333333s42.666667 149.333333 149.333333 149.333333h21.333334v85.333334a170.453333 170.453333 0 0 1-106.666667 158.293333z\" fill=\"#F2CAC1\" p-id=\"6377\"></path><path d=\"M682.666667 384s213.333333 0 213.333333 213.333333c0 0-213.333333 0-213.333333-213.333333zM128 597.333333c0-213.333333 213.333333-213.333333 213.333333-213.333333C341.333333 597.333333 128 597.333333 128 597.333333zM704 213.333333v64h-42.666667c-106.666667 0-149.333333-149.333333-149.333333-149.333333s-42.666667 149.333333-149.333333 149.333333h-42.666667v-64a192 192 0 0 1 384 0z\" fill=\"#7C8691\" p-id=\"6378\" data-spm-anchor-id=\"a313x.search_index.0.i1.49713a812B2MlJ\" class=\"selected\"></path><path d=\"M661.333333 853.333333h42.666667v149.333334h-42.666667zM320 853.333333h42.666667v149.333334h-42.666667zM490.666667 789.333333h42.666666v42.666667h-42.666666zM490.666667 874.666667h42.666666v42.666666h-42.666666z\" fill=\"#2A3244\" p-id=\"6379\"></path><path d=\"M810.666667 1024H213.333333a21.333333 21.333333 0 0 1-21.333333-21.333333V789.333333a192.234667 192.234667 0 0 1 192-192h42.666667v-85.333333h42.666666v106.666667a21.333333 21.333333 0 0 1-21.333333 21.333333h-64a149.504 149.504 0 0 0-149.333333 149.333333v192h554.666666v-192a149.504 149.504 0 0 0-149.333333-149.333333h-64a21.333333 21.333333 0 0 1-21.333333-21.333333v-106.666667h42.666666v85.333333h42.666667a192.234667 192.234667 0 0 1 192 192v213.333334a21.333333 21.333333 0 0 1-21.333333 21.333333zM704 298.666667h-21.333333v-85.333334a170.666667 170.666667 0 0 0-341.333334 0v85.333334h-21.333333a21.333333 21.333333 0 0 1-21.333333-21.333334v-64a213.333333 213.333333 0 0 1 426.666666 0v64a21.333333 21.333333 0 0 1-21.333333 21.333334z\" fill=\"#2A3244\" p-id=\"6380\"></path><path d=\"M512 554.666667a192.234667 192.234667 0 0 1-192-192v-85.333334a21.333333 21.333333 0 0 1 21.333333-21.333333h21.333334c89.6 0 128.448-132.522667 128.832-133.866667A21.333333 21.333333 0 0 1 512 106.666667a21.333333 21.333333 0 0 1 20.501333 15.445333C532.885333 123.456 572.16 256 661.333333 256h21.333334a21.333333 21.333333 0 0 1 21.333333 21.333333v85.333334a192.234667 192.234667 0 0 1-192 192z m-149.333333-256v64a149.333333 149.333333 0 0 0 298.666666 0v-64c-78.016 0-125.12-65.322667-149.333333-113.770667C487.786667 233.344 440.682667 298.666667 362.666667 298.666667z\" fill=\"#2A3244\" p-id=\"6381\"></path><path d=\"M704 405.333333h-21.333333v-42.666666h21.333333a21.333333 21.333333 0 0 0 0-42.666667h-21.333333v-42.666667h21.333333a64 64 0 0 1 0 128zM341.333333 405.333333h-21.333333a64 64 0 0 1 0-128h21.333333v42.666667h-21.333333a21.333333 21.333333 0 0 0 0 42.666667h21.333333z\" fill=\"#2A3244\" p-id=\"6382\"></path><path d=\"M896 618.666667c-2.346667 0-234.666667-2.688-234.666667-234.666667a21.333333 21.333333 0 0 1 21.333334-21.333333c2.346667 0 234.666667 2.688 234.666666 234.666666a21.333333 21.333333 0 0 1-21.333333 21.333334z m-191.061333-211.669334c11.349333 132.757333 120.661333 161.258667 168.789333 167.338667-11.349333-132.736-120.661333-161.258667-168.789333-167.338667zM128 618.666667a21.333333 21.333333 0 0 1-21.333333-21.333334c0-231.978667 232.32-234.666667 234.666666-234.666666a21.333333 21.333333 0 0 1 21.333334 21.333333C362.666667 615.978667 130.346667 618.666667 128 618.666667z m191.04-211.584c-48.106667 6.272-157.312 35.114667-168.746667 167.168 48.106667-6.293333 157.312-35.136 168.746667-167.168zM512 661.333333a85.333333 85.333333 0 0 1-85.333333-85.333333h42.666666a42.666667 42.666667 0 0 0 85.333334 0h42.666666a85.333333 85.333333 0 0 1-85.333333 85.333333z\" fill=\"#2A3244\" p-id=\"6383\"></path><path d=\"M554.666667 725.333333c-35.882667 0-64-37.482667-64-85.333333h42.666666c0 26.048 12.629333 42.666667 21.333334 42.666667a64 64 0 0 0 64-64h42.666666a106.794667 106.794667 0 0 1-106.666666 106.666666z\" fill=\"#2A3244\" p-id=\"6384\"></path><path d=\"M469.333333 725.333333a106.794667 106.794667 0 0 1-106.666666-106.666666h42.666666a64 64 0 0 0 64 64c8.704 0 21.333333-16.618667 21.333334-42.666667h42.666666c0 47.850667-28.117333 85.333333-64 85.333333z\" fill=\"#2A3244\" p-id=\"6385\"></path></svg>",
            "agentToolIconSvg": "<svg t=\"1721528326870\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"7439\" width=\"16\" height=\"16\">\n<path d=\"M191.978264 413.657237a489.852064 489.852064 0 0 0 219.704269 50.204458h2.629758a152.047786 152.047786 0 0 0 97.540089 39.685428 152.047786 152.047786 0 0 0 98.018226-39.685428h1.912551A486.983238 486.983238 0 0 0 831.009289 413.657237a23.906885 23.906885 0 0 0 5.498583-37.055671c-40.163566-41.837048-116.904665-213.010341-129.336245-248.631599a21.038058 21.038058 0 0 0-1.195345-3.586033 213.488479 213.488479 0 0 0-388.008736 0v2.868826C305.057828 163.591225 227.599522 334.764518 185.523406 376.601566a23.906885 23.906885 0 0 0-6.454859 19.842714 23.906885 23.906885 0 0 0 12.909717 17.212957z m393.746389 8.845548v1.673482a110.688875 110.688875 0 0 1-71.720654 32.274294c-66.939277 0-131.248796-88.455473-155.633818-174.281189 38.968222 5.259515 152.525923 14.105062 204.882001-49.965388a157.068232 157.068232 0 0 0 111.884219 27.731986 331.827558 331.827558 0 0 1-85.825715 161.610539z m133.161347-153.24313A939.062425 939.062425 0 0 0 783.195519 384.729907a439.647607 439.647607 0 0 1-129.097176 29.883606 397.332421 397.332421 0 0 0 64.787657-145.353858z m-146.310134-89.17268a23.906885 23.906885 0 0 0-21.277127-6.693927 23.906885 23.906885 0 0 0-17.212957 13.865993c-28.688261 68.612759-173.803051 51.877939-200.339692 42.554254a25.341298 25.341298 0 0 0-9.323685-1.434413c18.408301-39.924497 32.513363-73.633204 36.577533-85.347578A167.348192 167.348192 0 0 1 663.661097 143.509442c3.586033 10.040892 13.865993 35.14312 27.971055 66.22207a111.645151 111.645151 0 0 1-119.056286-29.644537z m-203.208518 234.765607a446.819672 446.819672 0 0 1-129.575314-30.122675A880.490558 880.490558 0 0 0 305.057828 269.259655a401.63566 401.63566 0 0 0 64.30952 145.592927zM654.576481 805.012938a31.318019 31.318019 0 1 0 31.318018-31.318019 31.318019 31.318019 0 0 0-31.318018 31.318019zM761.918392 805.012938a23.906885 23.906885 0 1 0 23.906885-23.906885 23.906885 23.906885 0 0 0-23.906885 23.906885z\" fill=\"#2c2c2c\" p-id=\"7440\"></path><path d=\"M132.689191 828.441684H558.470805a23.906885 23.906885 0 0 0 0-47.813769H159.70397c20.320852-126.22835 77.936444-211.814997 171.173294-254.60832a259.389697 259.389697 0 0 0 180.975116 78.65365A258.91156 258.91156 0 0 0 692.827496 526.019595c99.930777 47.813769 158.741713 141.050619 174.998395 281.6231a23.906885 23.906885 0 0 0 23.906884 20.798989h2.629758a23.906885 23.906885 0 0 0 20.798989-25.819435c-19.364576-165.67471-92.758712-275.168241-218.508925-324.894561a23.906885 23.906885 0 0 0-25.580366 5.737652 218.508925 218.508925 0 0 1-158.502645 75.545755A218.030787 218.030787 0 0 1 352.871597 483.226271a23.906885 23.906885 0 0 0-23.906884-5.020445C202.019156 527.214939 128.62502 636.70847 109.499513 802.38318a23.906885 23.906885 0 0 0 23.906884 26.058504zM902.729942 961.363962H121.213886a31.318019 31.318019 0 1 0 0 62.636038H902.729942a31.318019 31.318019 0 0 0 0-62.636038z\" fill=\"#2c2c2c\" p-id=\"7441\">\n</path></svg>",
            "useAgent": false,
            "promptIncludeEssay":false,
            "backgroundFileNameList":[],
            "chatgptParameters":[1000, 1, 2],

            "useRating": true,
        }
    ];


    var backgroundDocVOList = [
        {
            url: "https://example.com/ai-learning-analytics",
            documentContent: `Artificial intelligence (AI) has transformed the educational landscape, enabling more personalized and data-driven learning experiences.
              One of the most impactful applications of AI in education is learning analytics, which involves collecting and analyzing data on learners' behaviors,
              performance, and engagement. By leveraging learning analytics, educators can identify trends, make data-informed decisions, and provide timely
              interventions to support students who are struggling.

              For instance, AI can track student progress in real time, enabling teachers to understand how students are interacting with educational content.
              These insights help in tailoring learning materials to meet individual needs, thereby promoting more effective learning outcomes. As AI continues
              to evolve, the integration of learning analytics will likely become a cornerstone of modern educational practices, creating opportunities for more
              adaptive and personalized learning environments.`
        },
        {
            url: "https://example.com/ai-self-regulated-learning",
            documentContent: `Self-regulated learning (SRL) is a critical skill for students in the 21st century, enabling them to take control of their own learning by setting
              goals, monitoring progress, and reflecting on outcomes. AI tools are playing an increasingly important role in supporting SRL by offering personalized
              feedback and learning pathways tailored to students' individual needs.

              For example, AI-powered platforms can assess how well a student understands a concept and recommend resources to help them improve. These systems can
              also provide learners with timely reminders and suggestions on how to better manage their study schedules. By facilitating self-regulated learning,
              AI helps students develop lifelong learning skills, enhancing their ability to learn autonomously in both academic and professional contexts.`

        },
        {
            url: "https://example.com/ai-personalized-learning",
            documentContent: `The future of education is increasingly being shaped by AI, particularly in the area of personalized learning. Through technologies like learning
                      analytics and adaptive learning systems, AI can create highly customized educational experiences for students. Instead of a one-size-fits-all approach,
                      AI enables instruction that adjusts in real time to the needs of each learner.

                      In the context of personalized learning, AI systems can identify students' strengths and weaknesses, adapting lesson plans to maximize engagement and
                      mastery. Moreover, AI tools help educators monitor students' self-regulated learning behaviors, providing insights into how learners set goals,
                      stay on task, and manage their own learning strategies. As these AI-driven systems become more sophisticated, the potential for truly personalized,
                      self-paced learning will expand, making education more accessible and effective for all students.`
        }
    ];

    // ===============================================
    // var patientRoleDescription="You are a patient and please answer questions based on the provided text.";


    var chatgptBackgroundFileNameList = []; // add pdf file names here    TODO 使其可以支持docx 和pdf
    var chatgptRoleDescription = "你是一位乐于助人的助手，可以根据提供的文本回答问题。你只能提供修改建议，但不能为学生写作或总结整篇文章。你能理解中文和英文，但只能用中文回复问题"
    var CollaborateGPTRoleDescription = "You are an experienced assistant for essay writing. The graduate student is working on an essay writing task. You should not write or finish essays for students. Instead, you should help students by only answering their questions, regarding the essay task, e.g. if they are not sure of the meaning of a term or concept, organizing their arguments, citing properly. Maintain a supportive and encouraging tone throughout interactions, you should motivate students, especially when they encounter challenges in their writing process. Integrate advice on the essay structure, argument development, grammar mistakes and proofreading techniques. Keep your responses succinct.";

    var chatgptRole = "assistant";
    var chatgptPromptIncludeEssay = false;
    // var includeSurveyToChatgptPrompt = []; // [1, 2, 3]
    var chatgptParameters = [1000, 1, 2]; //  response max token, n, temperature/10
    var chatgptType = "chat";


    var useChecklistTool = false;
    var useChecklistToolGrammar = false;
    var useChecklistToolAcademic = false;
    var useChecklistToolOriginality = false;
    var useChecklistToolClassification = false;
    var useDictionaryTool = false;
    var dictionarySourceLanguage = "zh-cn";
    var dictionaryTargetLanguage = "en";
    var useTeacherChat = false;
    var useTimerTool = true;
    var useVideoRecordingTool = false;

    var toolsLanguage = "tha";

    var accessOtherCourseIdList = [];

    //----------------------------------更新工具 2.5.1
    var toolsDisplayTime = { //如果是 null 就不做修改，如果是有数值，则根据数值做修改,
        // annotation: [0, -1], //seconds，此配置表示从0 秒开始使用， 到-1 秒隐藏。 -1 表示永远不隐藏
        // annotationSearch: "",
        // scaffolds: "",
        // gptScaffolds: "",
        // essayWriting: [180, -1],
        // essayProductVisual: "",
        // zoteroNotes: "",
        // processVisual: "",
        // consultationSubmit: "",
        // collaborateWriting: "",
        // mathEditor: "",
        // planner: "",
        // checklist: "",
        // chatgpt: "",
        // multiAgentsSingleWindow: [0, -1],
        // dictionary: "",
        // teacherChat: "",
        // timer: "",
        // popupQuestionnaire: "",
    }

    var allowGptScaffoldsChat = false;
    var allowGptScaffoldsChatMultiAgents = false;
    var gptScaffoldAgent = {
        "agentDisplayName": "Instructor",
        "agentName": "cella3_scaffold_chat",
        "agentRole": "scaffold",
        "model": "gpt-4o",
        "agentDescription": "",
        "agentAvatarSvg": "<svg fill=\"#000000\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"><title>chatgpt icon</title><path d=\"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z\"/></svg>",
        "agentToolIconSvg": "",
        "useAgent": true,
        "agentPromptTemplate": "",
        "promptIncludeEssay": false,
        "agentBackgroundFileNameList": [],
        "agentParameters": [1000, 1, 2],
        "useRating": true,
        // "hasDefaultScaffolds": true,
        "triggerConfigs": {
            "triggerRule": "timeRangeTriggers",
            "timeRangeTriggers": [
                {triggerMinute: 7, beginMinute: 0, endMinute: 7, checkSrlProcess: "CSTR2/CMTR2",}, // 如果有多个SRL process可以使用;;; 分割, 例如CMTR2;;;CMTR1;;;CMTR1>CMTR2
                {triggerMinute: 21, beginMinute: 14, endMinute: 21, checkSrlProcess: "OT2",},
                {triggerMinute: 35, beginMinute: 28, endMinute: 35, checkSrlProcess: "CMTR1/CMTR2",}
            ],
            "fixedMessageTriggers": [
                {triggerMinute: 5, message: "This is test fixed message1"},
                {triggerMinute: 20, message: "This is test fixed message2"},
                {triggerMinute: 35, message: "This is test fixed message3"}
            ],
            "defaultTriggers": [ // default 中的 message 需要和前面配置的 message数量一致
                {triggerMinute: 7, message: "You’re doing a great job! Keep it up!"},
                {triggerMinute: 21, message: "You’re doing a great job! Keep it up!"},
                {triggerMinute: 35, message: "You’re doing a great job! Keep it up!"}
            ]
        }
    };

    /*var gptScaffoldReturnMessages = [
        {
            triggerMinute: 5, message: "This is test fixed message1"
        },
        {
            triggerMinute: 20, message: "This is test fixed message2"
        },
        {
            triggerMinute: 35, message: "This is test fixed message3"
        }
    ];*/
    // var hasDefaultScaffolds = true;
    var hasDefaultScaffoldsPrompt = false; //只在Oulu study 使用

    //For NHB paper only
    let nhbTaskConfig = "gpt-only"; // gpt-only, search-only, gpt-search, search-gpt
    const task1Minutes = 2;
    const task2Minutes = 2;

    const toolList1 = [];

    // var studyName = "cella_oulu_task2_ai_in_edu_groupB"; //change to "uniSA" if needed
    var studyName = "cella3_monash_B"; //change to "uniSA" if needed
    function loadScript(url) {
        let currentDate = new Date();

        // Get the year, month, and day from the date object
        let year = currentDate.getFullYear();
        let month = currentDate.getMonth() + 1; // Month is 0-indexed
        let day = currentDate.getDate();

        // Pad the month and day with leading zeros if they are less than 10
        month = month < 10 ? '0' + month : month;
        day = day < 10 ? '0' + day : day;

        // Concatenate the year, month, and day to form the desired format
        let formattedDate = year.toString() + month.toString() + day.toString();

        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = url + "?v=" + formattedDate;
        // var script = document.createElement("script");
        // script.type = "text/javascript";
        // script.src = url;
        script.defer = true;
        script.async = false;
        document.head.appendChild(script);
    }
    function getURLParameters(url) {
        var params = {};
        var parser = document.createElement('a');
        parser.href = url;
        var query = parser.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            params[pair[0]] = decodeURIComponent(pair[1]);
        }
        return params; // string 类型
    }
    // let navTagA = document.querySelector("#page-navbar>nav>ol>li>a"); //this element saves the courseId in Moodle webpage
    const ol = document.querySelector("#page-navbar>nav>ol.breadcrumb");
    var currentCourseId = 101; // test toefl to set 1
    if (ol) {
        const liList = ol.querySelectorAll('li');
        if (liList.length >= 2) {
            const secondLastLi = liList[liList.length - 2];
            const a = secondLastLi.querySelector('a');
            if (a) {
                // console.log(a.href); // 这里就是你想要的 url
                currentCourseId = getURLParameters(a.href).id;
                a.onclick = "return false;";
            }
        }
    }
</script>
<script>
    // script usage  在这里读取相应的script


    loadScript("/flora/js/text.js");
    loadScript("/flora/js/i18n_function.js");
    loadScript("/flora/js/generateToolsHtml.js");
    loadScript("/flora/js/tools_00common.js");
    loadScript("/flora/js/tools_00common_chat.js");
    // // if(useTimerTool) 不确定timer是否需要按需加载
    loadScript("/flora/js/tools_08timer.js");


    if(useAnnotationTool) loadScript("/flora/js/tools_01annotation.js");
    if(useScaffoldTool) loadScript("/flora/js/tools_02scaffolding.js");
    if(useWriteEssayTool) loadScript("/flora/js/tools_03essay_writing.js");

    if(usePlannerTool) loadScript("/flora/js/tools_04planner.js");
    // if(useChatgptTool) loadScript("/flora/js/tools_05chatgpt.js");
    // if(typeof useChatgptAssistantTool !== 'undefined' && useChatgptAssistantTool) loadScript("/flora/js/tools_05_1chatgpt_assistant.js");
    // if(typeof useToeflAssistantTool!=='undefined' && useToeflAssistantTool) loadScript("/flora/js/tools_14toefl_assistant.js");
    // if(typeof useChatgptAssistantTeacherTool !=='undefined' && useChatgptAssistantTeacherTool) loadScript("/flora/js/tools_05_2chatgpt_assistant_teacher.js");
    if(useChecklistTool) loadScript("/flora/js/tools_06checklist.js");
    if(useVideoRecordingTool) {
        loadScript("/flora/js/MediaStreamRecorder.js");
        loadScript("/flora/js/tools_09record_video.js");
    }

    if(typeof useConsultationSubmitTool !== 'undefined' && useConsultationSubmitTool) {
        loadScript("/flora/js/tools_13consultation_submit.js");
    }

    if (typeof useMultiAgentsMultiWindowsTool !== 'undefined' && useMultiAgentsMultiWindowsTool) {
        loadScript("/flora/js/tools_15multi_agents_multi_windows.js");
    }
    if (typeof useMultiAgentsSingleWindowTool !== 'undefined' && useMultiAgentsSingleWindowTool) {
        loadScript("/flora/js/tools_15multi_agents_single_window.js");
    }
    if (typeof useMedicalScaffoldMultiAgentsSingleWindowTool !== 'undefined' && useMedicalScaffoldMultiAgentsSingleWindowTool) {
        loadScript("/flora/js/tools_15multi_agents_single_window_medical_scaffold.js");
    }
    if (typeof useTigeCheckMultiAgentsSingleWindowTool !== 'undefined' && useTigeCheckMultiAgentsSingleWindowTool) {
        loadScript("/flora/js/tools_15multi_agents_single_window_tige_check.js");
    }
    if (typeof useAssistCheckMultiAgentsSingleWindowTool !== 'undefined' && useAssistCheckMultiAgentsSingleWindowTool) {
        loadScript("/flora/js/tools_15multi_agents_single_window_assist_check.js");
    }

    if(useDictionaryTool) loadScript("/flora/js/tools_10dictionary.js");
    if(useTeacherChat) loadScript("/flora/js/tools_11teacherchat.js");
    if (useCollaborativeWriteEssayTool) loadScript("/flora/js/tools_12collaboratewrite.js");
    if (useZoteroNotesTool) loadScript("/flora/js/tools_16zoteronotes.js");
    if (useProcessVisualTool) loadScript("/flora/js/tools_17process_visual.js");
    if (useEssayProductAnalysisTool) loadScript("/flora/js/tools_17essay_product_visual.js");
    if (useGPTScaffoldTool) loadScript("/flora/js/tools_07gpt_scaffolding.js");
    if (useMathEditorTool) loadScript("/flora/js/tools_16matheditor.js");

    // loadScript("/flora/js/tools_20submit_dialogue_label.js");
    // loadScript("/flora/js/tools_21jimmie_study.js");
    loadScript("/flora/js/setupInstrumentationTools.js");


</script>
<!--    <script async src="https://cse.google.com/cse.js?cx=07c7c130962f14f5f"> </script>-->


<!--end_PLUGINS_GENERICO_TEMPLATE_BODY-->