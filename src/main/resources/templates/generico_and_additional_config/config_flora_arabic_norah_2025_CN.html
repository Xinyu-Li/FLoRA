<!--start_PLUGINS_GENERICO_TEMPLATE_BODY-->

<script src="/flora/js/jquery.min.js"></script>
<script src="/flora/js/etherpad.js"></script>
<script src="/flora/js/diff.js"></script>
<link href="/flora/css/bootstrap.min.css" rel="stylesheet"/>
<script src="/flora/js/bootstrap.bundle.min.js"></script>
<!--    <script src="/flora/js/jquery-ui.min.js" id="myJqueryUI" ></script>-->
<script src="/flora/js/quill.min.js"></script>
<!--    <script src="/js/flipclock.js"></script>-->
<script src="/flora/js/flipdown.min.js"></script>
<script src="/flora/js/mathquill.min.js"></script> <!-- Include MathQuill JS -->

<script src="/flora/js/d3.min.js"></script>
<script src="/flora/js/jsmind.js"></script>
<script src="/flora/js/jsmind_draggable_node.js"></script>


<script>
    var currentRange = null;
    var whetherDoHighlight = false;
    var saveHighlight = null;
    var saveHighlightText = '';

    var totalMinutes = 45;
    var unlimitedTime = false; //如果使用unlimited time 则让timer 变成增长，不再是count down
    var hintMinutesBeforeEnd = 5;
    var isCountdown = true;

    let eventWebsocket = null;
    let teacherChatWebsocket = null;

    var apiBaseUrl = "http://localhost:8080";
    var websocketApiBaseUrl = "ws://localhost:8080";
    var mainEditor = null;
    var editors = {}; //多个不同的侧边栏editor

    // 是否展示工具
    var useAnnotationTool = true;
    var useScaffoldTool = false; // enable
    var useGPTScaffoldTool = false;

    var srlModel = "maria";    // copes
    var gptScaffoldRole = "assistant";

    // var gptScaffoldRoleDescription = "You are a helpful assistant, please give suggestions based on the given text.";
    var gptScaffoldPromptIncludeEssay = true;
    var gptScaffoldPromptTemplate = `As a personal tutor aiding a student in a multi-source writing task, your goal is to enhance the student's metacognitive awareness based on provided guidelines and student-specific information. A scaffold is any subtle factor that influences behavior in a predictable way without restricting alternatives or significantly altering incentives. These scaffolds aim to indirectly invite students’ metacognitive awareness relating to trigger events, that is, events and/or situations that may inhibit learning processes and, thus, require regulatory responses. In this case, the triggers relate to the presence or absence of certain processes. Metacognitive awareness refers to a learner’s knowledge of what they have and have not learned, as well as of their own cognitive processes. It involves identifying and reflecting on discrepancies between their current state and standards through metacognitive monitoring, which sets the stage for evaluating the effectiveness of current approach and regulatory responses, such as the timely adjustments of learning strategies or goals.
Scaffolds are provided as reflective questions to elicit learners’ awareness on the possible opportunities inviting to regulate learning. In this task, provide metacognitive scaffolds for three different parts of the task by considering the relevant processes that the student has implemented (section 2.3) before that specific time point. We provide you with a standard message, and it is crucial that you tailor it only regarding the part of the message specified with the corresponding processes (consider all the reported processes together), otherwise keep the standard message the same and under 40 words. You recognise which scaffold to use based on the processes provided to you in that phase. Please, provide only the scaffold for the phase.

Scaffold #1: Task understanding - students assess task requirements, constraints (e.g. time), and the internal (e.g. knowledge of tactics) and external factors (e.g. available source materials, learning tools) influencing the task, set goals and devise plans; Scaffold #2: Monitoring reading - evaluating alignment between reading materials and comprehension of them and the task goals and plans; Scaffold #3: Monitoring writing - evaluating alignment between the essay draft and the task criteria. You recognize which scaffold to use by the processes in section 2.3.

Standard message for scaffold #1: Hei! Kuten varmaan tiedät, tehtävän aluksi on hyvä tutustua sen ohjeisiin, tavoitteisiin ja annettuihin materiaaleihin. Joko sinulle on selvää, mitä sinulta odotetaan tässä tehtävässä? Entä millainen suunnitelma sinulla on tehtävän suorittamiseksi? Suunnitelma ja jotkin työkaluista voivat auttaa, jotta löydät mahdollisimman tehokkaan tavan tavoitteidesi saavuttamiseksi.

For example, if we detect student returning to task instructions after attempting to write and we have not detected them familiarizing with the task material, basing on the scaffold instructions we give you, replace the second sentence of the message above with the something like following (just example):

Hei! Kuten varmaan tiedät, tehtävän aluksi on hyvä tutustua sen ohjeisiin, tavoitteisiin ja annettuihin materiaaleihin. Millaisen materiaalin pohjalta kirjoitelma kuuluisi annetussa ajassa tehdä tehtävän tavoitteisiin pääsemiseksi? Suunnitelma ja jotkin työkaluista voivat auttaa, jotta löydät mahdollisimman tehokkaan tavan tavoitteidesi saavuttamiseksi.

Standard message for scaffold #2: Hei! Edistäähän tämänhetkinen työskentelytapasi tehtävässä suoriutumista? Miten voit hyödyntää aiheen sisällön tuntemustasi kirjoittamisessa? Kun luet annettuja materiaaleja, kysy itseltäsi ”Miten tämä tieto liittyy tehtävän aiheeseen? Mitä uutta näkökulmaa se tuo aiheeseen?”

Standard message for scaffold #3: Hei! Pysähdy hetkeksi miettimään, miten kirjoittamisesi edistyy. Mitä voisit vielä tehdä varmistaaksesi, että kirjoitelmasi vastaa tehtävän tavoitteita? Miten voisit vielä kehittää työskentelytapaasi esseen sisältöjä syventääksesi?

section 2.3

;;;SRL_PROCESS_PROMPT;;;

Provide only one scaffold and only the scaffold message, considering all the provided processes are together, and keep it around 40 words.`;

    var hasDefaultScaffoldsPrompt = false;
    var gptScaffoldBackgroundFileNameList = [];
    var gptScaffoldParameters = [200, 1, 2]; //  response max token, n, temperature/10


    var testISDIMUCourseId = 2;
    var hasTakePreviousStudyTestNameCourseId = 2;
    var pretestNameCourseId = 2;

    //default 表示 >= 11
    var pretestGradesPrompt = [{"threshold": 0, "prompt": "This student has a high level of knowledge about AI in medicine.", "scaffoldSrlProcess": []},  // 根据scaffolding 的 个数来添加相应的 SRL process 的个数
        //此处 11 表示 <= 10
        {"threshold": 11, "prompt": "This student has a low level of knowledge about AI in medicine.", "scaffoldSrlProcess": []}]; //LCR2--LCF2 表示这两个SRL process 需要对比频次
    var isdimuScorePrompt = [{"threshold": 0, "prompt": "This student seems to have good understanding of various strategies or techniques that can be applied to facilitate learning.", "scaffoldSrlProcess": []},
        {"threshold": 16, "prompt": "This student seems to have a low level of understanding of various strategies or techniques that can be applied to facilitate learning.", "scaffoldSrlProcess": []},
        {"threshold": 32, "prompt": "This student seems to have some understanding of various strategies or techniques that can be applied to facilitate learning.", "scaffoldSrlProcess": []}];
    //
    // var userTakePreviousStudyPrompt = "This student has participated in the prior study so he/she has a certain level of task knowledge.";

    var classifySentenceBackgroundFileNameList = ["CELLA_main_task_reading.docx"]; // cella_monash_main_task2_medicine.docx, TODO 使其可以支持docx 和pdf

    var srlProcessBackupPromptList = [
        {
            "scaffoldNumber": 0,
            "srlProcess": "CMTR1",
            "srlProcessFreqComparison": "",
            "notExistPrompt": "not exist",
            "existPrompt": "",
            "threshold": 0,
            "appearOverThresholdPrompt": "",
            "appearLessThanEqualThresholdPrompt": "",
            "appearOverOther": "",
            "appearLessThanOther": "",
        }

    ];

    var gptScaffoldReturnMessages = [
    ];
    var gptScaffoldNeedCheckSRLProcessPrompt = [
        {
            triggerMinute: 5,
            beginMinute: 0,
            endMinute: 5,
            checkSrlProcess: "MCE2;;;LCF2;;;MCP1",
        },
        {
            triggerMinute: 20,
            beginMinute: 5,
            endMinute: 20,
            checkSrlProcess: "LCR2;;;HCEO1;;;HCEO3",
        },
        {
            triggerMinute: 35,
            beginMinute: 20,
            endMinute: 35,
            checkSrlProcess: "HCEO1;;;MCE2;;;LCF2",
        }
    ];


    var useWriteEssayTool = true;
    var useEssayProductAnalysisTool = false;
    var allowEssayProductAnalysis = false;
    var useWriteEssayWordCountButton = true;
    var useCollaborativeWriteEssayTool = false;
    var useCollaborativeWriteEssayWordCountButton = true;
    var includeChatgptToCollaborativeWriteEssay = true;
    var useMathEditorTool = false;

    var usePlannerTool = true;
    var useChatgptTool = false;

    var useZoteroNotesTool = false;
    var useProcessVisualTool = false;

    var useChatgptRating = true; // chatgpt rating visible or not
    var useChatgptAssistantTool = false;
    var useChatgptAssistantRating = false; // chatgpt assistant rating visible or not
    var useDoctorScaffold = false;

    // =========use type for different patient, scaffold and assessment================
    var medicalConsultAssistanceType = "linmei_4o";
    var useChatgptAssistantTeacherTool = false;
    var assistantPatientName = "林美";
    var assistantTeacherName = "陈医生";
    var medicalConsultAssistantTeacherType = "linmei_4o";
    var assistantTeacherLimitRound = 10;
    var useChatgptAssistantTeacherRating = false;
    var usercolor4pad = "%23FCF3CF";
    var useToeflAssistantTool = false;
    var useToeflAssistantRating = false;
    // var toeflStructureExpertName = "Alice";
    // var toeflGrammarExpertName = "Grace";
    // var toeflLanguageExpertName = "Elina";
    // var toeflMediatorName = "Lily";

    // var ruleBasedMessageAskAllExpert = "现在你已经与三位专家都进行了对话。如果你还有其他问题，你可以继续和相应专家进行交流，但是请注意我们的修改时间限制；如果你没有其他问题，请对总结你认为修改的比较好的地方，并在课后加以积累。" // notice: 似乎有病句
    // var ruleBasedMessageNoTalkToExpert = "同学你好！我已经收到了你的文章。你认为这篇文章哪里需要改进？你在写作过程中遇到了什么困难？" // 任务开始5min内
    // var ruleBasedMessageNoTalkToAllExpert = "“请注意把握好时间，修改好这个问题后，可以想一想自己还需要和哪位专家进行讨论，改进文章其他方面存在的问题。" // 与专家对话开始10min 20min后
    var startMediatorMessage = "同学你好，我是协调员，负责引导你完成今天的文章修改任务。我看到你已经完成了一篇学术讨论，你认为这篇文章哪里需要改进？你在写作过程中遇到了什么困难呢？";
    var notAskAnyOneTime = 2; // 2min
    var notifyAskAllExpertTime = 15; // 15min or 30min 没有跟专家都谈话
    // var expertRoleDescription = "专家";

    // from 95 to 113, map it to 94 to 112
    var relatedCourseIdMap = {
        95: 94,
        96: 95,
        97: 96,
        98: 97,
        99: 98,
        100: 99,
        101: 100,
        102: 101,
        103: 102,
        104: 103,
        105: 104,
        106: 105,
        107: 106,
        108: 107,
        109: 108,
        110: 109,
        111: 110,
        112: 111,
        113: 112
    };

    var multiAgent4CollaborativeChatConfig = [
        {
            "agentDisplayName":"Mediator",
            "agentName":"mediator_discuss_01",// 根据课程不同需要修改 eg mediator_write_01
            "agentRole":"mediator",
            "model":"gpt-4o",
            "agentDescription":"You are the mediator. Please answer all the questions.",

            "agentAvatarSvg": "<svg t=\"1721961683121\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"5712\" width=\"35\" height=\"35\"><path d=\"M903.616 0C969.984 0 1024 54.016 1024 120.384V903.68A120.576 120.576 0 0 1 903.552 1024H120.384A120.512 120.512 0 0 1 0 903.616V120.32C0 54.016 54.016 0 120.384 0H903.68z m0 69.12H120.32a51.328 51.328 0 0 0-51.264 51.264V903.68c0 28.288 23.04 51.264 51.264 51.264H903.68c28.288 0 51.264-23.04 51.264-51.264V120.32a51.392 51.392 0 0 0-51.264-51.264zM501.952 288v58.56H268.928v115.904h218.944v58.56H268.928v126.528h242.944v58.496H200.384V288h301.568z m224.832 107.136c75.52 0 113.6 40.96 113.6 124.16v186.752h-66.752V525.12c0-49.728-22.848-74.368-68.48-74.368a61.12 61.12 0 0 0-43.328 17.6c-14.08 12.864-22.272 31.616-24.64 55.68v182.016H570.432v-302.72h66.752v35.2c9.408-11.264 19.84-20.672 31.232-27.52l8.64-4.736c15.424-7.616 32.512-11.392 49.728-11.136z\" fill=\"#f9d6ff\" p-id=\"5713\"></path></svg>",
            "agentToolIconSvg": "",

            "useAgent": false,
            "promptIncludeEssay":true,
            "backgroundFileNameList":[],
            "chatgptParameters":[1000,1,2],
        }
    ];

    var useMultiAgentsSingleWindowTool = false;
    var useMultiAgentsSingleWindowRating = false;
    // 所有description 都暂时没用
    // rating 部分添加到 工具层面，不能留到agent层面控制
    // 每个 agent config 都要加 useAgent 参数
    // scaffold Agent 触发方式有两种，一种是按时间触发，一种是按轮数触发，可以同时存在
    // 测试单个窗口，窗口内有多个agents
    var multiAgentsSingleWindowConfig =
        {
            // 此处的agents 表示可以聊天的agents， scaffold agents 表示可以触发scaffolding 的agents，
            // 同一个agent 可以同时handle聊天和scaffold，需要在config里面重复写入
            "agents": [
                {
                    "agentDisplayName":"Mediator",
                    "agentName":"mediator_discuss_01",// 根据课程不同需要修改 eg mediator_write_01
                    "agentRole":"mediator",
                    "model":"gpt-4o",
                    "agentDescription":"You are the mediator. Please answer all the questions.",

                    "agentAvatarSvg": "<svg t=\"1721961683121\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"5712\" width=\"35\" height=\"35\"><path d=\"M903.616 0C969.984 0 1024 54.016 1024 120.384V903.68A120.576 120.576 0 0 1 903.552 1024H120.384A120.512 120.512 0 0 1 0 903.616V120.32C0 54.016 54.016 0 120.384 0H903.68z m0 69.12H120.32a51.328 51.328 0 0 0-51.264 51.264V903.68c0 28.288 23.04 51.264 51.264 51.264H903.68c28.288 0 51.264-23.04 51.264-51.264V120.32a51.392 51.392 0 0 0-51.264-51.264zM501.952 288v58.56H268.928v115.904h218.944v58.56H268.928v126.528h242.944v58.496H200.384V288h301.568z m224.832 107.136c75.52 0 113.6 40.96 113.6 124.16v186.752h-66.752V525.12c0-49.728-22.848-74.368-68.48-74.368a61.12 61.12 0 0 0-43.328 17.6c-14.08 12.864-22.272 31.616-24.64 55.68v182.016H570.432v-302.72h66.752v35.2c9.408-11.264 19.84-20.672 31.232-27.52l8.64-4.736c15.424-7.616 32.512-11.392 49.728-11.136z\" fill=\"#f9d6ff\" p-id=\"5713\"></path></svg>",
                    "agentToolIconSvg": "",

                    "useAgent": false,
                    "promptIncludeEssay":true,
                    "backgroundFileNameList":[],
                    "chatgptParameters":[1000,1,2],
                },
            ],
            "scaffoldAgents": [
                // toefl agents config
                {
                    "agentDisplayName":"Mediator",
                    "agentName":"mediator_discuss_01",// 根据课程不同需要修改 eg mediator_write_01
                    "agentRole":"mediator",
                    "model":"gpt-4o",
                    "agentDescription":"You are the mediator. Please answer all the questions.", // scaffolds 的配置都直接写到此处

                    "agentAvatarSvg": "",
                    "agentToolIconSvg": "",

                    "useAgent": false,
                    "promptIncludeEssay": true,
                    "backgroundFileNameList": [],
                    "chatgptParameters": [1000,1,2],
                    "scaffoldsBasedRounds": [
                        // 两种scaffold 形式，一种是直接以chat形式发回gpt response，看起来就是自动对话。
                        // 一种是无头像的promptMessage 形式，看起来像是提醒消息
                        // {
                        //     "triggerAllChatRound": -1,       // -1 表示不触发
                        //
                        //     "triggerAgentChatRound": [ //表示监控与某个agent的对话轮数超过round 时候触发
                        //         {"agentName": "expert_grammar", "priority": "1", "round": 8, "extraPrompt": "The student has talked with the grammar expert."},
                        //         {"agentName": "expert_structure", "priority": "2", "round": 8, "extraPrompt": "The student has talked with the structure expert"},
                        //         {"agentName": "expert_language", "priority": "3", "round": 8, "extraPrompt": "The student has talked with the language expert"}],  // priority 1 最高
                        //     "triggerRepeat": false,  // 组合规则，不能repeat
                        //
                        //     "displayFormat": "chat",
                        //
                        // },
                        // {
                        //     "triggerAllChatRound": 0,   // 不可能每0轮触发一次, 如果为0，则只在开头触发一次
                        //     "triggerAgentChatRound": [],
                        //     "triggerRepeat": false,  // 按轮数触发，如果改成true，表示每 xx 轮触发一次
                        //     "displayFormat": "promptMessage",
                        //     "extraPrompt": "Hello, I am the tutor today. I am here to help you. Do you have any questions during the learning process?" //同学你好，我是协调员，负责引导你完成今天的文章修改任务。我看到你已经完成了一篇学术讨论，你认为这篇文章哪里需要改进？你在写作过程中遇到了什么困难呢？
                        // }
                        {
                            "triggerAllChatRound": 3,   // 不可能每0轮触发一次, 如果为0，则只在开头触发一次
                            "triggerRepeat": false,  // 按轮数触发，如果改成true，表示每 xx 轮触发一次
                            "displayFormat": "promptMessage",
                            "extraPrompt": "Hello, I am the tutor today. I am here to help you. Do you have any questions during the learning process?" //同学你好，我是协调员，负责引导你完成今天的文章修改任务。我看到你已经完成了一篇学术讨论，你认为这篇文章哪里需要改进？你在写作过程中遇到了什么困难呢？
                        }
                    ],
                    "scaffoldsBasedTime": [
                        // { //scaffolds 的描述都直接写入到GPT 配置中去 （agentDescription），此处只需要写出触发时间或者轮数
                        //
                        //     "triggerMinute": 15,
                        //     "triggerRepeat": false,  // 按时间触发，如果改成true，表示每15分钟触发一次
                        //     "displayFormat": "chat",
                        //     "extraPrompt": ""
                        // },
                        // {
                        //
                        //     "triggerMinute": 5,
                        //     "triggerRepeat": false,  // 按时间触发，如果改成true，表示每15分钟触发一次
                        //     "displayFormat": "chat",
                        //     "extraPrompt": ""
                        // }
                    ]
                },
                // {
                //     "agentDisplayName":"Mediator",
                //     "agentName":"mediator_discuss_02",// 根据课程不同需要修改 eg mediator_write_01
                //     "agentRole":"mediator",
                //     "model":"gpt-4o",
                //     "agentDescription":"You are the mediator. Please answer all the questions.", // scaffolds 的配置都直接写到此处
                //
                //     "agentAvatarSvg": "",
                //     "agentToolIconSvg": "",
                //
                //     "useAgent": true,
                //     "promptIncludeEssay": true,
                //     "backgroundFileNameList": [],
                //     "chatgptParameters": [1000,1,2],
                //     "scaffoldsBasedRounds": [],
                //     "scaffoldsBasedTime": [
                //         // 两种scaffold 形式，一种是直接以chat形式发回gpt response，看起来就是自动对话。
                //         // 一种是无头像的promptMessage 形式，看起来像是提醒消息
                //
                //         { //scaffolds 的描述都直接写入到GPT 配置中去 （agentDescription），此处只需要写出触发时间或者轮数
                //
                //             "triggerMinute": 25,
                //             "triggerRepeat": false,  // 按时间触发，如果改成true，表示每15分钟触发一次
                //             "displayFormat": "chat",
                //             "extraPrompt": ""
                //         }
                //     ]
                // }
            ]
        };


    <!--        var multiAgent4CollaborativeChatConfig = multiAgentsSingleWindowConfig;-->

    var useMultiAgentsMultiWindowsTool = false;

    var useMultiAgentsMultiWindowsRating = false;
    // 字数限制
    var wordCountLimit = 300;
    var allowPaste = false;
    var allowCopy = true;
    // 测试多窗口，每个窗口一个agent
    var useConsultationSubmitTool = false;
    var multiAgentsMultiWindowsConfig = [
        {
            "agentDisplayName": "贝可可",
            "agentName": "mayor_beranda",
            "agentRole": "mayor",
            "model":"gpt-4o",
            "agentDescription": "You are the mayor of Beranda. Please answer all the questions.",

            "agentAvatarSvg": "<svg t=\"1720921759115\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"3165\" width=\"35\" height=\"35\"><path d=\"M486.1 488.4c107.5 0 195-86 195-191.7 0-105.7-87.5-191.7-195-191.7s-195 86-195 191.7c0 105.7 87.5 191.7 195 191.7z m0-349.5c88.5 0 160.5 70.8 160.5 157.8s-72 157.8-160.5 157.8-160.5-70.8-160.5-157.8c0-87 72-157.8 160.5-157.8z m0 261.4c58.2 0 105.4-46.4 105.5-103.7 0-9.4-7.7-17-17.3-17-9.5 0-17.3 7.6-17.3 17 0 38.5-31.8 69.7-70.9 69.7-39.2 0-70.9-31.2-70.9-69.7 0-9.4-7.7-17-17.3-17-9.5 0-17.3 7.6-17.3 17 0.1 57.3 47.3 103.7 105.5 103.7zM692 508.7H280.5c-60.3 0.1-109.1 48.1-109.2 107.3v198.7c0 9.4 7.7 17 17.3 17 9.5 0 17.3-7.6 17.3-17V616c0-40.5 33.5-73.4 74.7-73.5H692c41.2 0 74.7 32.9 74.7 73.5v198.7c0 4.5 1.8 8.8 5 12 3.2 3.2 7.6 5 12.2 5 9.5 0 17.2-7.6 17.2-17V616c0-59.2-48.9-107.3-109.1-107.3z m-188.7 69.5c-2.1-7.2-8.9-12.2-16.5-12.2s-14.4 4.9-16.5 12.1l-53 176.4c-1.8 5.9-0.2 12.2 4.2 16.6l53 53.6c3.2 3.3 7.7 5.1 12.4 5.1 4.5 0 8.8-1.7 12-4.8l53-50.5c4.6-4.4 6.3-10.9 4.6-16.9l-53.2-179.4zM487.2 789l-34-34.4 33.4-111.4 33.7 114.1-33.1 31.7z\" fill=\"#6B6B6B\" p-id=\"3166\"></path></svg>",
            "agentToolIconSvg": "<svg t=\"1713954810237\" class=\"icon\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\"><title>assistant mayor icon</title>\n            <path d=\"M511.83 795.59l-46.4-80.82 93.2 0.23z\" fill=\"#2c2c2c\" p-id=\"3341\" data-spm-anchor-id=\"a313x.search_index.0.i1.46d93a810kQjDt\" className=\"selected\"></path>\n            <path d=\"M511.83 556.45l-46.4 158.37 93.2-0.53z\" fill=\"#2c2c2c\" p-id=\"3342\" data-spm-anchor-id=\"a313x.search_index.0.i0.46d93a810kQjDt\" className=\"selected\"></path>\n            <path d=\"M723.88 929.64H300.17c-50.9 0-98.87-19.94-135.08-56.15-36.21-36.21-56.15-84.18-56.15-135.08 0-50.9 19.94-98.87 56.15-135.08 36.21-36.21 84.18-56.15 135.08-56.15h423.71c50.9 0 98.87 19.94 135.08 56.15 36.21 36.21 56.15 84.18 56.15 135.08 0 50.9-19.94 98.87-56.15 135.08-36.2 36.21-84.18 56.15-135.08 56.15zM300.17 607.18c-72.36 0-131.23 58.87-131.23 131.23 0 72.36 58.87 131.23 131.23 131.23h423.71c72.36 0 131.23-58.87 131.23-131.23 0-72.36-58.87-131.23-131.23-131.23H300.17zM512.03 513.91C396.77 513.91 303 420.14 303 304.88S396.77 95.85 512.03 95.85c50.32 0 177.71 0.24 178.99 0.25l29.92 0.06 0.02 29.92c0 1.31 0.1 131.34 0.1 178.81 0 115.25-93.77 209.02-209.03 209.02z m0-358.06C429.85 155.85 363 222.7 363 304.88s66.85 149.03 149.03 149.03 149.03-66.86 149.03-149.03c0-33.29-0.05-107.23-0.08-148.84-41.08-0.08-113.83-0.19-148.95-0.19z\" p-id=\"3343\"></path>\n        </svg>",
            "useAgent": true,
            "promptIncludeEssay": false,
            "backgroundFileNameList": [],
            "chatgptParameters": [1000, 1, 2],
        }
    ];


    var agentsConfig = [
        // toefl agents config
        {
            "chatName":"Mediator",
            "agentName":"Mediator",
            "agentType":"mediator_discuss_01",// 根据课程不同需要修改 eg mediator_write_01
            "agentRole":"mediator",
            "agentDescription":"You are the mediator. Please answer all the questions.",
            "useToeflMediator":true,
            "promptIncludeEssay":true,
            "backgroundFileNameList":[],
            "model":"gpt-4o",
            "chatgptParameters":[1000,1,2],
            "scaffold":[
                {
                    "scaffoldType":"mediator_discuss_01", // 根据课程不同需要修改 eg mediator_write_01
                    "scaffoldRole":"mediator_instruction",
                    "scaffoldDescription":"任务进行了一定时间后，协调员帮助学生分析文章的问题，引导学生思考文章的改进方向。",
                    "triggerMinute":15,
                },
                {
                    "scaffoldType":"mediator_discuss_02", // 根据课程不同需要修改 eg mediator_write_02
                    "scaffoldRole":"mediator_scaffold",
                    "scaffoldDescription":"与任一专家对话达到一定轮数后，协调员帮助学生分析文章的问题，引导学生思考文章的改进方向。",
                    "triggerRound":8,
                }
            ]
        },
    ]

    var backgroundDocVOList = [
        {
            url: "https://example.com/ai-learning-analytics",
            documentContent: `Artificial intelligence (AI) has transformed the educational landscape, enabling more personalized and data-driven learning experiences.
              One of the most impactful applications of AI in education is learning analytics, which involves collecting and analyzing data on learners' behaviors,
              performance, and engagement. By leveraging learning analytics, educators can identify trends, make data-informed decisions, and provide timely
              interventions to support students who are struggling.

              For instance, AI can track student progress in real time, enabling teachers to understand how students are interacting with educational content.
              These insights help in tailoring learning materials to meet individual needs, thereby promoting more effective learning outcomes. As AI continues
              to evolve, the integration of learning analytics will likely become a cornerstone of modern educational practices, creating opportunities for more
              adaptive and personalized learning environments.`
        },
        {
            url: "https://example.com/ai-self-regulated-learning",
            documentContent: `Self-regulated learning (SRL) is a critical skill for students in the 21st century, enabling them to take control of their own learning by setting
              goals, monitoring progress, and reflecting on outcomes. AI tools are playing an increasingly important role in supporting SRL by offering personalized
              feedback and learning pathways tailored to students' individual needs.

              For example, AI-powered platforms can assess how well a student understands a concept and recommend resources to help them improve. These systems can
              also provide learners with timely reminders and suggestions on how to better manage their study schedules. By facilitating self-regulated learning,
              AI helps students develop lifelong learning skills, enhancing their ability to learn autonomously in both academic and professional contexts.`

        },
        {
            url: "https://example.com/ai-personalized-learning",
            documentContent: `The future of education is increasingly being shaped by AI, particularly in the area of personalized learning. Through technologies like learning
                      analytics and adaptive learning systems, AI can create highly customized educational experiences for students. Instead of a one-size-fits-all approach,
                      AI enables instruction that adjusts in real time to the needs of each learner.

                      In the context of personalized learning, AI systems can identify students' strengths and weaknesses, adapting lesson plans to maximize engagement and
                      mastery. Moreover, AI tools help educators monitor students' self-regulated learning behaviors, providing insights into how learners set goals,
                      stay on task, and manage their own learning strategies. As these AI-driven systems become more sophisticated, the potential for truly personalized,
                      self-paced learning will expand, making education more accessible and effective for all students.`
        }
    ];




    // ===============================================
    var patientRoleDescription="You are a patient and please answer questions based on the provided text.";
    var assessmentRoleDescription="You are a helpful assistant and please answers questions based on the provided text.";

    var chatgptBackgroundFileNameList = []; // add pdf file names here    TODO 使其可以支持docx 和pdf
    var chatgptRoleDescription = "你是一位乐于助人的助手，可以根据提供的文本回答问题。你只能提供修改建议，但不能为学生写作或总结整篇文章。你能理解中文和英文，但只能用中文回复问题"
    var CollaborateGPTRoleDescription = "You are an experienced assistant for essay writing. The graduate student is working on an essay writing task. You should not write or finish essays for students. Instead, you should help students by only answering their questions, regarding the essay task, e.g. if they are not sure of the meaning of a term or concept, organizing their arguments, citing properly. Maintain a supportive and encouraging tone throughout interactions, you should motivate students, especially when they encounter challenges in their writing process. Integrate advice on the essay structure, argument development, grammar mistakes and proofreading techniques. Keep your responses succinct.";

    var chatgptRole = "assistant";
    var chatgptPromptIncludeEssay = true;
    // var includeSurveyToChatgptPrompt = []; // [1, 2, 3]
    var chatgptParameters = [1000, 1, 2]; //  response max token, n, temperature/10
    var chatgptType = "chat";

    var useChecklistTool = false;
    var useChecklistToolGrammar = true;
    var useChecklistToolAcademic = true;
    var useChecklistToolOriginality = true;
    var useChecklistToolClassification = false;
    var useDictionaryTool = false;
    var dictionarySourceLanguage = "zh-cn";
    var dictionaryTargetLanguage = "en";
    var useTeacherChat = false;
    var useTimerTool = true;
    var useVideoRecordingTool = false;

    var toolsLanguage = "ar";

    var accessOtherCourseIdList = [];


    const toolList1 = [];

    // var studyName = "cella_oulu_task2_ai_in_edu_groupB"; //change to "uniSA" if needed
    var studyName = "cella_oulu_study3"; //change to "uniSA" if needed
    function loadScript(url) {
        let currentDate = new Date();

        // Get the year, month, and day from the date object
        let year = currentDate.getFullYear();
        let month = currentDate.getMonth() + 1; // Month is 0-indexed
        let day = currentDate.getDate();

        // Pad the month and day with leading zeros if they are less than 10
        month = month < 10 ? '0' + month : month;
        day = day < 10 ? '0' + day : day;

        // Concatenate the year, month, and day to form the desired format
        let formattedDate = year.toString() + month.toString() + day.toString();

        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = url + "?v=" + formattedDate;
        // var script = document.createElement("script");
        // script.type = "text/javascript";
        // script.src = url;
        script.defer = true;
        script.async = false;
        document.head.appendChild(script);
    }
    function getURLParameters(url) {
        var params = {};
        var parser = document.createElement('a');
        parser.href = url;
        var query = parser.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            params[pair[0]] = decodeURIComponent(pair[1]);
        }
        return params; // string 类型
    }
    // let navTagA = document.querySelector("#page-navbar>nav>ol>li>a"); //this element saves the courseId in Moodle webpage
    const ol = document.querySelector("#page-navbar>nav>ol.breadcrumb");
    var currentCourseId = 101; // test toefl to set 1
    if (ol) {
        const liList = ol.querySelectorAll('li');
        if (liList.length >= 2) {
            const secondLastLi = liList[liList.length - 2];
            const a = secondLastLi.querySelector('a');
            if (a) {
                // console.log(a.href); // 这里就是你想要的 url
                currentCourseId = getURLParameters(a.href).id;
                a.onclick = "return false;";
            }
        }
    }
</script>

<script>
    //清除 trace data，正式环境删除掉, // TODO 需要测试一下 此处和generico 哪个先执行，可能需要移到Generico里面
    // controller defined in TestController
    function clearTraceData() {
        localStorage.clear();
        $.get(apiBaseUrl + "/clear-user-log-data/2");
        // console.log("clear trace data")
    }
    // clearTraceData();

</script>
<script>
    // script usage  在这里读取相应的script


    loadScript("/flora/js/text.js");
    loadScript("/flora/js/i18n_function.js");
    loadScript("/flora/js/generateToolsHtml.js");
    loadScript("/flora/js/tools_00common.js");

    if(useAnnotationTool) loadScript("/flora/js/tools_01annotation.js");
    if(useScaffoldTool) loadScript("/flora/js/tools_02scaffolding.js");
    if(useWriteEssayTool) loadScript("/flora/js/tools_03essay_writing.js");
    if(usePlannerTool) loadScript("/flora/js/tools_04planner.js");
    if(useChatgptTool) loadScript("/flora/js/tools_05chatgpt.js");
    if(typeof useChatgptAssistantTool !== 'undefined' && useChatgptAssistantTool) loadScript("/flora/js/tools_05_1chatgpt_assistant.js");
    if(typeof useToeflAssistantTool!=='undefined' && useToeflAssistantTool) loadScript("/flora/js/tools_14toefl_assistant.js");
    if(typeof useChatgptAssistantTeacherTool !=='undefined' && useChatgptAssistantTeacherTool) loadScript("/flora/js/tools_05_2chatgpt_assistant_teacher.js");
    if(useChecklistTool) loadScript("/flora/js/tools_06checklist.js");
    if(useVideoRecordingTool) {
        loadScript("/flora/js/MediaStreamRecorder.js");
        loadScript("/flora/js/tools_09record_video.js");
    }

    if(typeof useConsultationSubmitTool !== 'undefined' && useConsultationSubmitTool) {
        loadScript("/flora/js/tools_13consultation_submit.js");
    }

    if (typeof useMultiAgentsMultiWindowsTool !== 'undefined' && useMultiAgentsMultiWindowsTool) {
        loadScript("/flora/js/tools_15multi_agents_multi_windows.js");
    }
    if (typeof useMultiAgentsSingleWindowTool !== 'undefined' && useMultiAgentsSingleWindowTool) {
        loadScript("/flora/js/tools_15multi_agents_single_window.js")
    }
    // // if(useTimerTool) 不确定timer是否需要按需加载
    loadScript("/flora/js/tools_08timer.js");
    if(useDictionaryTool) loadScript("/flora/js/tools_10dictionary.js");
    if(useTeacherChat) loadScript("/flora/js/tools_11teacherchat.js");
    if (useCollaborativeWriteEssayTool) loadScript("/flora/js/tools_12collaboratewrite.js");
    if(useZoteroNotesTool) loadScript("/flora/js/tools_16zoteronotes.js");
    if(useProcessVisualTool) loadScript("/flora/js/tools_17process_visual.js");
    if (useEssayProductAnalysisTool) loadScript("/flora/js/tools_17essay_product_visual.js");
    if(useGPTScaffoldTool) loadScript("/flora/js/tools_07gpt_scaffolding.js");
    if(useMathEditorTool) loadScript("/flora/js/tools_16matheditor.js");
    loadScript("/flora/js/setupInstrumentationTools.js");


</script>

<!--end_PLUGINS_GENERICO_TEMPLATE_BODY-->